---
import HeaderLink from "./HeaderLink.astro";
import ThemeToggle from "./ThemeToggle.astro";
import { SITE_TITLE } from "../config";
---

<header>
	<div class="logo">
		<h2><a href="/">{SITE_TITLE}</a></h2>
	</div>

	<nav>
		<div class="nav-controls">
			<button class="mobile-menu-toggle" aria-label="打开菜单">
				<svg viewBox="0 0 24 24" width="24" height="24">
					<path
						fill="currentColor"
						d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path>
				</svg>
			</button>
			<div class="right-section">
				<div class="internal-links nav-links">
					<HeaderLink href="/">首页</HeaderLink>
					<HeaderLink href="/blog">博客</HeaderLink>
					<HeaderLink href="/about">关于</HeaderLink>
				</div>
				<ThemeToggle />
			</div>
		</div>
	</nav>
	<style>
		header {
			margin: 0;
			padding: 0 1em;
			background: rgb(var(--card-background));
			box-shadow: var(--box-shadow);
			border-bottom: 1px solid rgb(var(--border));
			position: sticky;
			top: 0;
			z-index: 100;
		}
		h2 {
			margin: 0;
			font-size: 1.2em;
			font-weight: 700;
		}

		h2 a,
		h2 a.active {
			text-decoration: none;
			color: rgb(var(--black));
		}

		nav {
			display: flex;
			align-items: center;
			height: var(--navbar-height);
		}

		nav a {
			padding: 0.5em;
			color: rgb(var(--gray-dark));
			border-bottom: 2px solid transparent;
			text-decoration: none;
			font-weight: 500;
			transition:
				color 0.2s ease,
				border-color 0.2s ease;
		}

		nav a:hover {
			color: var(--accent);
		}

		nav a.active {
			text-decoration: none;
			border-bottom-color: var(--accent);
			color: var(--accent);
		}

		.right-section {
			display: flex;
			align-items: center;
			margin-left: auto;
		}

		@media (max-width: 768px) {
			.nav-links {
				display: none;
				position: absolute;
				top: 100%;
				left: 0;
				right: 0;
				background: rgb(var(--card-background));
				flex-direction: column;
				padding: 1rem;
				box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
				z-index: 100;
			}

			.nav-links.active {
				display: flex;
			}

			.mobile-menu-toggle {
				display: block;
			}

			.internal-links {
				gap: 1rem;
			}

			.social-links {
				display: none;
			}
		}

		@media (max-width: 480px) {
			.logo {
				width: 100%;
			}

			.mobile-menu-toggle {
				padding: 0.5rem;
				color: rgb(var(--black));
			}

			.nav-links {
				padding: 0.5rem;
			}
		}
	</style>

	<script is:inline>
		// 移动端菜单交互逻辑
		document.addEventListener("DOMContentLoaded", () => {
			const menuToggle = document.querySelector(".mobile-menu-toggle");
			const navLinks = document.querySelector(".nav-links");

			// 切换菜单显示状态
			menuToggle?.addEventListener("click", (e) => {
				e.stopPropagation();
				navLinks.classList.toggle("active");
			});

			// 点击页面其他区域关闭菜单
			document.addEventListener("click", () => {
				navLinks.classList.remove("active");
			});

			// 阻止菜单区域点击事件冒泡
			navLinks?.addEventListener("click", (e) => {
				e.stopPropagation();
			});
		});
	</script>
</header>
